# TDD

### 테스트는 무엇인가?

- 소프트웨어 제품, 서비스의 품질 확인
- 제품(특정 기능, 함수, UI, 성능)이 예상대로 동작하는지 확인
- expectation, 요구 사항에 맞게 테스트 코드를 작성한다.

### 언제 테스트 코드를 작성해야할까?

- [테스트 코드 도입 X] Dev -> QA -> Publish

  - 수동적으로 테스트를 해야하는 환경이므로, 시간(비용)이 증가 한다.
  - 개발팀에서 개발을 아무리 빠르게 해도, QA 팀에서 병목 현상이 발생한다.

- [테스트 코드 도입 O] 테스트코드와 스크립트를 통해 QA 단계를 자동화 한다.

  - 개발을 하면서 테스트를 작성하고 확인 => 자동화, 속도 향상
  - QA 팀에서는 사용자 입장에서의 테스트를 통해 서비스의 품질을 높인다.

### 테스트 코드 왜 작성해야할까?

- 기능을 개발하는 동시에 테스트를 하는 것이기 때문에 기능이 정상 동작할 가능성이 높다.
- 요구 사항을 완벽하게 이해해야지 테스트 코드를 작성할 수 있기 때문에 요구 사항에 만족하는 코드를 작성할 수 있다.
- 개발 단계에서 버그를 빠르게 발견할 수 있다.
- 코드 간의 의존성을 낮추어야 테스트 코드를 작성할 수 있기 때문에 자연스럽게 의존성이 낮은 코드를 작성할 수 있다.
- 테스트 코드 자체가 좋은 문서화가 될 수 있다.

### 🔼 테스트 피라미드

1.  Unit Test(단위 테스트)

    - 독립적인 함수 모듈 클래스를 테스트 (바퀴에 대한 테스트)

2.  Integration Test(통합 테스트)

    - 여러가지의 단위를 묶었을 때 정상적으로 상호작용되어 테스트 되는지를 테스트 (엔진이 올라갔을 떄 바퀴가 제대로 굴러가는지)

3.  E2E Test

    - UI, 사용자 테스트 (사용자가 자동차를 운전하는 상황을 가정한 테스트)

> - 단계가 높아질수록 개발 비용이 높아진다.
> - 단계가 높아질수록 테스트 하는 내용이 커지므로 속도가 느려진다.

### 좋은 테스트 코드를 위해선?

1. 한 번 작성된 테스트 코드는 **영원히** 유지보수 되어야한다.

   - 내부 구현 사항을 테스트 하면 안된다. (너무 세세한 내부 구현 사항을 테스트 하지 않는다., 사용자 입장에서의 테스트만을 작성하도록 한다.)
   - 재사용성 높이기
   - 배포용 코드와 분리하기
   - **테스트 코드는 기능 검증용 뿐만 아니라, 문서화 되도록 유지해야 한다.**

2. (Arrange, Act, Assert | Given When Then) pattern

   - Given [준비]

     - 테스트에 사용되는 변수, 입력 값, Mock 객체 정의
     - 반복되는 부분은 유틸리티 함수 등으로 분리해서 재사용하는 것이 좋다.

   - When [실행]

     - 실제 구체화하고자하는 액션
     - 의도적으로 실패하는 테스트를 작성하거나 실제 버그가 발생하는 상황을 파악 후 코드를 개선하며 테스트를 성공시키도록 해보는게 좋다.

   - Then [검증]

     - 테스트를 검증하는 과정, 예상한 값, 실제 리턴된 값을 검증
     - 하나의 테스트에서 검증 단계의 양이 많아진다면, 다른 테스트로 분리해서 진행할 수 있는지 연구하며 독립적인 테스트를 작성할 수 있도록 하는 것이 좋다.

3. F I R S T

   - Fast : 느린것에 대한 의존성 낮추기, Mock, Stub 등으로 데이터베이스나 네트워크 등을 대체한다.
   - Isolated : 최소한의 유닛으로 독립적이고 집중적으로 검증하도록 한다.
   - Repeatable : 실행 할 때마다 동일한 결과를 유지한다. 매 실행마다 실패와 성공 여부가 달라지면 나쁜 테스트 코드다. 환경에 영향을 받지 않는 테스트 코드를 작성해라.
   - Self-Validating : 스스로 결과를 검증하도록 한다. 자동화를 통한 검증을 한다(CI/CD).
   - Timely : 사용자에게 배포되기 전, 테스트 코드를 작성하고 빠르게 문제를 발견하고 해결하도록 한다.

### 무엇을 테스트할 것 인가? (Right-BICEP)

- Boundary confitions : 모든 케이스에 대해서 테스트하기
- Inverse relationship : 일관성 유지
- Cross-check : 다른 수단을 이용해서 결과값이 맞는지 확인
- Error conditions : 네트워크 에러, 메모리 부족 등의 예상한 에러 케이스들을 통과하는지 확인
- Performance characteristics : 성능 개선의 척도화 확인도 테이터를 통해 확인

> [Right-BICEP and CORRECT in unit testing](https://blog.krybot.com/a?ID=01350-b2b37af1-55a8-4a61-908b-9b4f56f021b7)

## TDD (Test Driven Development, 테스트 주도 개발)

### TDD 개발 방식

1. 코드를 작성하기 전, 테스트 코드를 작성한다.
2. 테스트코드가 성공할 정도의 코드를 작성한다.
3. 1, 2 과정을 반복하면서 요구 사항에 맞는 테스트 코드와 그에 맞는 코드를 작성한다.
4. 3번 과정으로 기능 개발이 완료 되었다면, 테스트가 성공되면서 본인이 만족할 수 있도록 코드를 리팩토링하는 과정을 거친다.

### TDD를 도입하므로써 얻을 수 있는 장점?

- TDD를 적용하기 위해선, 사용자 입장에서 코드를 작성해야만 하기 때문에 자연스럽게 UX에 대한 부분도 고려하며 코드를 작성할 수 있을 것 같다.
- 요구 사항에 대해서 완벽하게 이해를 해야 테스트 코드를 작성할 수 있기 때문에 자연스럽게 기획 요구 사항에 대한 이해도도 높아질 것 같다.
- decoupling 된 코드를 작성할 수 있기 때문에 프로젝트 전반적인 설계가 향상 될 것이다.
- 테스트 코드 만으로 코드가 어떤 기능을 위한 것이고 어떻게 작동 되는 것임을 파악할 수 있어 협업 시 문서화 효과를 볼 수 있을 것이다.

> TDD는 어떠한 프레임워크에 대한 내용이 아닌, 개발하는 방식에 대한 것이다.
>
> - 요즘엔 코드의 신뢰도를 높이기 위해 테스트 코드 작성이 당연 시 되는 분위기 같다. 나도 테스트 코드 작성 달인이 되고시프다... <del>(너무 어려버~~~~)</del>

### UI에 대한 테스트 코드도 작성하나..?

- 대부분의 프론트엔드 개발자 분들이 UI 테스트를 하진 않는다. (너무 고난이도..)
- UI에서 비즈니스 로직을 따로 분리하고 그 비지니스 로직 부분만 테스트한다.
